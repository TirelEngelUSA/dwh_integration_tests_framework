def test_increment_size_for_dags(vial_prefix, live_prefix, tedi_dag, tedi_gp_target, GP_integration,
                                 contour_short_name, package) -> None:
    # ... ваш существующий код ...

    # получаем текущий vial_имя в формате schema.table
    vial_schema, vial_table_name = set_prefix_in_schema(vial_prefix, tedi_gp_target)
    vial_name = f'{vial_schema}.{vial_table_name}'

    # 1) получить старое физическое имя (с тем же префиксом, что и vial_name)
    old_phys = package.get_name_of_table_before_renaming(vial_name, 'GpTable', prefix=vial_prefix)
    # поведение:
    # - если таблица не переименовывалась -> вернёт vial_name
    # - если переименовывалась -> вернёт старое phys-имя с тем же префиксом
    # - если объект не найден -> вернёт None

    # 2) (альтернатива) если нужно старое мета-имя (без префикса)
    old_meta = package.get_table_name_before_renaming(vial_table_name)  # передаём текущее мета-имя

    # пример проверки
    if old_phys is None:
        pytest.skip(f'Не удалось определить старое имя для {vial_name}')
    else:
        allure.attach(str(old_phys), name='Old phys name', attachment_type=allure.attachment_type.TEXT)

    # ... остальной код теста ...


@pytest.fixture
def package_dag(request, tedi_dag: str, package_dag_factory, package) -> TediDag:
    def package_dag_teardown():
        pass
    request.addfinalizer(package_dag_teardown)

    # создаём объект TediDag через фабрику
    dag = package_dag_factory(tedi_dag)

    # пробуем получить старое имя дага из пакета (если оно есть)
    try:
        old_name = package.get_dag_name_before_renaming(tedi_dag)
    except Exception:
        old_name = None

    # сохраняем подсказку о старом имени прямо в объекте TediDag,
    # чтобы можно было посмотреть, как фикстура его заполняет
    # (позже можно будет передавать это значение в конструктор TediDag)
    setattr(dag, 'old_name_hint', old_name)

    return dag


def test_some(vial_prefix, package_dag, package):
    # package_dag — это TediDag, дополненный атрибутом old_name_hint
    old = getattr(package_dag, 'old_name_hint', None)
    print('old_name_hint =', old)
    # или assert/attach в allure


old_dag_names = {d: self.package_analyzer.get_dag_name_before_renaming(d) for d in dags}


        old_dag_names = {d: self.package_analyzer.get_dag_name_before_renaming(d) for d in dags}

        ids: List[str] = []
        params: List[Tuple[str, str]] = []
        for dag in dags:
            # use old name if it exists and differs from current
            old = old_dag_names.get(dag)
            dag_to_use = old if (old and old != dag) else dag
